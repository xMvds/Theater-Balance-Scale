
/* (zelfde file als je nu had, maar met 1 extra blok voor lockedAfterConfirm) */

:root{
  --bg:#0b0d12;
  --panel:rgba(0,0,0,0.22);
  --border:rgba(255,255,255,0.08);
  --text:rgba(255,255,255,0.92);
  --bad:rgba(255,65,65,0.95);
}

*{box-sizing:border-box}
html,body{height:100%}
/* Reserve the vertical scrollbar to prevent a visible layout "knip" when
   the scoreboard panel changes page height. */
html{
  overflow-y: scroll;
  background: var(--bg);
  /* Prevent mobile Safari from auto-scaling text (can cause subtle clipping at some zoom levels). */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  /* Base background color lives on html; body is transparent so our fixed glow layer sits behind content */
  background: transparent;
  color: var(--text);
  position: relative;
  z-index: 0;
  overflow-x: hidden;
}

/* Background glow (fixed, oversized) so it never shows a hard "cut" edge when scrolling */
body::before{
  content:"";
  position: fixed;
  inset: -60vmax;
  pointer-events: none;
  z-index: -1;
  background:
    radial-gradient(1700px 1150px at 50% 18%, rgba(255,255,255,0.070) 0%, rgba(255,255,255,0.032) 38%, rgba(255,255,255,0.010) 68%, rgba(0,0,0,0) 92%),
    radial-gradient(1200px 900px at 15% 78%, rgba(255,255,255,0.040) 0%, rgba(0,0,0,0) 70%),
    radial-gradient(1200px 900px at 85% 78%, rgba(255,255,255,0.040) 0%, rgba(0,0,0,0) 70%);
}

/* Subtle vignette so the very bottom of the viewport never becomes a bright band */
body::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background: linear-gradient(to bottom, rgba(11,13,18,0) 0%, rgba(11,13,18,0) 72%, rgba(11,13,18,0.65) 100%);
}

/* === Player background (original) === */

/* Player page: stronger soft background glows + a gentle "breathing" pulse.
   (Host/Info keep the static glow.) */
body:not(.hostPage):not(.infoPage)::before{
  background:
    radial-gradient(1700px 1150px at 50% 18%, rgba(255,255,255,0.115) 0%, rgba(255,255,255,0.050) 38%, rgba(255,255,255,0.018) 68%, rgba(0,0,0,0) 92%),
    radial-gradient(1200px 900px at 15% 78%, rgba(255,255,255,0.060) 0%, rgba(0,0,0,0) 72%),
    radial-gradient(1200px 900px at 85% 78%, rgba(255,255,255,0.060) 0%, rgba(0,0,0,0) 72%),
    radial-gradient(1000px 700px at 50% 105%, rgba(255,255,255,0.030) 0%, rgba(0,0,0,0) 70%);
  animation: bgBreath 6.5s ease-in-out infinite;
  will-change: transform, opacity;
}

@keyframes bgBreath{
  0%,100%{ transform: scale(1.00); opacity: 0.88; }
  50%{ transform: scale(1.03); opacity: 1; }
}

/* === END Player background (original) === */

/* === Player background (static image, based on v3.0.0.47 preset C) ===
   - No animation
   - Single high-res baked image for a "sharp" look
*/
html.playerStaticBg{
  background: #0d1424 url("bg_player_static_c.png") center / cover no-repeat;
}
body.playerStaticBg{
  background: #0d1424 url("bg_player_static_c.png") center / cover no-repeat;
}
body.playerStaticBg::before,
body.playerStaticBg::after{
  display:none !important;
}
/* === END Player background (static image) === */

/* === Player background test (B): animated blobs (host-controlled) ===
   - Experimental: may introduce banding in some browsers.
   - Controlled from the host BG test buttons (A/B/C).
*/
@keyframes bgMoveBlobs {
  100% { transform: translate3d(0, 0, 1px) rotate(360deg); }
}

.playerBgB{
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  background: #0c0f17;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
}

.playerBgB span {
  width: 50vmin;
  height: 50vmin;
  border-radius: 50vmin;
  backface-visibility: hidden;
  position: absolute;
  animation: bgMoveBlobs;
  animation-duration: 5s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
}

/* NOTE: nth-child is 1-based. Mapped from your 0-10 list to 1-11. */
.playerBgB span:nth-child(1) {
  color: #1f2333;
  top: 20%;
  left: 47%;
  animation-duration: 327s;
  animation-delay: -182s;
  transform-origin: -7vw 18vh;
  box-shadow: -100vmin 0 13.018604517833134vmin currentColor;
}
.playerBgB span:nth-child(2) {
  color: #151823;
  top: 60%;
  left: 4%;
  animation-duration: 406s;
  animation-delay: -240s;
  transform-origin: -3vw 22vh;
  box-shadow: 100vmin 0 12.762316256973838vmin currentColor;
}
.playerBgB span:nth-child(3) {
  color: #151823;
  top: 35%;
  left: 52%;
  animation-duration: 395s;
  animation-delay: -278s;
  transform-origin: 15vw 8vh;
  box-shadow: -100vmin 0 13.10218522027612vmin currentColor;
}
.playerBgB span:nth-child(4) {
  color: #1f2333;
  top: 61%;
  left: 60%;
  animation-duration: 365s;
  animation-delay: -402s;
  transform-origin: 6vw -12vh;
  box-shadow: -100vmin 0 13.129990102642967vmin currentColor;
}
.playerBgB span:nth-child(5) {
  color: #151823;
  top: 21%;
  left: 43%;
  animation-duration: 80s;
  animation-delay: -189s;
  transform-origin: 4vw -3vh;
  box-shadow: -100vmin 0 12.970115741215873vmin currentColor;
}
.playerBgB span:nth-child(6) {
  color: #1f2333;
  top: 19%;
  left: 50%;
  animation-duration: 309s;
  animation-delay: -334s;
  transform-origin: -2vw -16vh;
  box-shadow: 100vmin 0 12.895642837460437vmin currentColor;
}
.playerBgB span:nth-child(7) {
  color: #151823;
  top: 65%;
  left: 95%;
  animation-duration: 185s;
  animation-delay: -298s;
  transform-origin: 21vw 21vh;
  box-shadow: -100vmin 0 13.043346555256644vmin currentColor;
}
.playerBgB span:nth-child(8) {
  color: #1f2333;
  top: 7%;
  left: 2%;
  animation-duration: 360s;
  animation-delay: -255s;
  transform-origin: -6vw -22vh;
  box-shadow: -100vmin 0 13.180322529513408vmin currentColor;
}
.playerBgB span:nth-child(9) {
  color: #151823;
  top: 21%;
  left: 67%;
  animation-duration: 353s;
  animation-delay: -24s;
  transform-origin: 23vw -3vh;
  box-shadow: 100vmin 0 12.529782245365437vmin currentColor;
}
.playerBgB span:nth-child(10) {
  color: #1f2333;
  top: 64%;
  left: 46%;
  animation-duration: 293s;
  animation-delay: -397s;
  transform-origin: -19vw 23vh;
  box-shadow: -100vmin 0 13.003822493961914vmin currentColor;
}
.playerBgB span:nth-child(11) {
  color: #1f2333;
  top: 67%;
  left: 45%;
  animation-duration: 302s;
  animation-delay: -390s;
  transform-origin: -19vw 8vh;
  box-shadow: -100vmin 0 12.500936929610136vmin currentColor;
}

/* === Player background test (C): FinisherHeader particles (host-controlled) === */
.playerBgC{
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  background: #151823;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
}
.playerBgC canvas{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* === END Player background test (B) === */


/* v3.0.0.54 static bg patch: prevent any top "seam" from dynamic viewport/safe-area */
html.playerStaticBg, body.playerStaticBg{
  min-height: 100%;
}

/* === Host: background test (A/B) ===
   A = current static image background (bg_player_static_c.png)
   B = animated blobs (your snippet)
*/
html.hostBgModeA,
body.hostBgModeA{
  background: #0d1424 url("bg_player_static_c.png") center / cover no-repeat;
}
body.hostBgModeA::before,
body.hostBgModeA::after{
  display:none !important;
}

html.hostBgModeB{ background:#0c0f17; }
body.hostBgModeB{
  background: transparent;
}
body.hostBgModeB::before,
body.hostBgModeB::after{
  display:none !important;
}

/* Animated blob background (B) */
@keyframes move {
  100% { transform: translate3d(0, 0, 1px) rotate(360deg); }
}
.hostBgB{
  position: fixed;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  background: #0c0f17;
  overflow: hidden;
  pointer-events: none;
  z-index: -1;
}
.hostBgB span {
  width: 50vmin;
  height: 50vmin;
  border-radius: 50vmin;
  backface-visibility: hidden;
  position: absolute;
  animation: move;
  animation-duration: 5s;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
}

/* NOTE: nth-child is 1-based. Mapped from your 0-10 list to 1-11. */
.hostBgB span:nth-child(1) {
  color: #1f2333;
  top: 20%;
  left: 47%;
  animation-duration: 327s;
  animation-delay: -182s;
  transform-origin: -7vw 18vh;
  box-shadow: -100vmin 0 13.018604517833134vmin currentColor;
}
.hostBgB span:nth-child(2) {
  color: #151823;
  top: 60%;
  left: 4%;
  animation-duration: 406s;
  animation-delay: -240s;
  transform-origin: -3vw 22vh;
  box-shadow: 100vmin 0 12.762316256973838vmin currentColor;
}
.hostBgB span:nth-child(3) {
  color: #151823;
  top: 35%;
  left: 52%;
  animation-duration: 395s;
  animation-delay: -278s;
  transform-origin: 15vw 8vh;
  box-shadow: -100vmin 0 13.10218522027612vmin currentColor;
}
.hostBgB span:nth-child(4) {
  color: #1f2333;
  top: 61%;
  left: 60%;
  animation-duration: 365s;
  animation-delay: -402s;
  transform-origin: 6vw -12vh;
  box-shadow: -100vmin 0 13.129990102642967vmin currentColor;
}
.hostBgB span:nth-child(5) {
  color: #151823;
  top: 21%;
  left: 43%;
  animation-duration: 80s;
  animation-delay: -189s;
  transform-origin: 4vw -3vh;
  box-shadow: -100vmin 0 12.970115741215873vmin currentColor;
}
.hostBgB span:nth-child(6) {
  color: #1f2333;
  top: 19%;
  left: 50%;
  animation-duration: 309s;
  animation-delay: -334s;
  transform-origin: -2vw -16vh;
  box-shadow: 100vmin 0 12.895642837460437vmin currentColor;
}
.hostBgB span:nth-child(7) {
  color: #151823;
  top: 65%;
  left: 95%;
  animation-duration: 185s;
  animation-delay: -298s;
  transform-origin: 21vw 21vh;
  box-shadow: -100vmin 0 13.043346555256644vmin currentColor;
}
.hostBgB span:nth-child(8) {
  color: #1f2333;
  top: 7%;
  left: 2%;
  animation-duration: 360s;
  animation-delay: -255s;
  transform-origin: -6vw -22vh;
  box-shadow: -100vmin 0 13.180322529513408vmin currentColor;
}
.hostBgB span:nth-child(9) {
  color: #151823;
  top: 21%;
  left: 67%;
  animation-duration: 353s;
  animation-delay: -24s;
  transform-origin: 23vw -3vh;
  box-shadow: 100vmin 0 12.529782245365437vmin currentColor;
}
.hostBgB span:nth-child(10) {
  color: #1f2333;
  top: 64%;
  left: 46%;
  animation-duration: 293s;
  animation-delay: -397s;
  transform-origin: -19vw 23vh;
  box-shadow: -100vmin 0 13.003822493961914vmin currentColor;
}
.hostBgB span:nth-child(11) {
  color: #1f2333;
  top: 67%;
  left: 45%;
  animation-duration: 302s;
  animation-delay: -390s;
  transform-origin: -19vw 8vh;
  box-shadow: -100vmin 0 12.500936929610136vmin currentColor;
}

/* Host UI: small A/B toggle panel (lives next to the debug copy button) */
.bgTestPanel{
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(10,10,10,.58);
  padding: 10px 10px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.bgTestTitle{
  font-size: 11px;
  letter-spacing: .14em;
  text-transform: uppercase;
  color: rgba(255,255,255,.70);
}
.bgTestBtns{ display:flex; gap:8px; }
.bgTestBtn{
  flex:1;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.20);
  color: rgba(255,255,255,.86);
  padding: 10px 12px;
  font-size: 12px;
  letter-spacing: .14em;
  text-transform: uppercase;
  cursor: pointer;
}
.bgTestBtn:hover{ background: rgba(0,0,0,.34); }
.bgTestBtn.active{
  border-color: rgba(255,255,255,.28);
  box-shadow: 0 0 18px rgba(255,255,255,.10);
  background: rgba(0,0,0,.46);
}
/* === END Host background test === */


.hidden{display:none !important}

/* When a tab is in the background, browsers throttle animations/timers.
   We snap UI to its final state while hidden and also disable CSS motion so
   you never "see" a delayed animation when returning to the tab. */
body.noAnim #panelGame,
body.noAnim .playerPanel,
body.noAnim .scorePanel,
body.noAnim .scorePanel *,
body.noAnim .tile,
body.noAnim .mathRow,
body.noAnim .scoreNum,
body.noAnim .playerRevealOverlay,
body.noAnim .playerRevealOverlay *{
  transition: none !important;
  animation: none !important;
}

body.noAnim:not(.hostPage):not(.infoPage)::after{ animation: none !important; }

.wrap{
  min-height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:18px;
  position:relative;
  z-index:1;
}


.card{
  width:min(760px, 100%);
  border:1px solid var(--border);
  /*
    IMPORTANT:
    The old outer box-shadow gets visibly "cut off" when the user scrolls
    and the element approaches the viewport edge (browser clips shadows at
    the viewport boundary). To avoid the hard cutoff, we render the depth
    entirely INSIDE the card using inset shadows + an internal glow layer.
  */
  background:
    radial-gradient(900px 520px at 50% 0%, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 42%, rgba(0,0,0,0) 88%),
    var(--panel);
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.05),
    inset 0 0 50px rgba(0,0,0,0.35);
}

.top{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  padding:16px 16px 10px;
  border-bottom:1px solid rgba(255,255,255,0.06);
}
.title{
  letter-spacing:0.14em;
  text-transform:uppercase;
  font-size:14px;
  color:rgba(255,255,255,0.85);
}
.subtitle{
  margin-top:6px;
  font-size:12px;
  color:rgba(255,255,255,0.45);
}

.centerCol{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:16px;
  padding:16px;
}

/* ===== Join ===== */
.join{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  min-height: 240px;
}
.joinBox{
  width:min(520px, 100%);
  display:grid;
  gap:10px;
  padding:16px;
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
}
.joinHint{
  font-size:12px;
  color: rgba(255,255,255,0.45);
  letter-spacing:0.02em;
}

.input{
  width:100%;
  padding:12px 12px;
  font-size:14px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.35);
  color: var(--text);
  outline:none;
}
.input:focus{ border-color: rgba(255,255,255,0.25); }

/* ===== Buttons ===== */
.btn{
  padding:10px 12px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.25);
  color: rgba(255,255,255,0.85);
  cursor:pointer;
}
.btn.primary{
  border-color: rgba(255,255,255,0.25);
  background: rgba(255,255,255,0.08);
}
.btn:disabled{ opacity:0.45; cursor:not-allowed; }

/* Host — Next button feedback during reveal/scoreboard animation */
@keyframes hostNextPulse {
  0%, 100% { box-shadow: 0 0 0 1px rgba(255,80,80,0.12), 0 0 18px rgba(255,80,80,0.10); }
  50%      { box-shadow: 0 0 0 1px rgba(255,80,80,0.18), 0 0 26px rgba(255,80,80,0.14); }
}
.hostPage .btn.nextLocked{
  border-color: rgba(255,80,80,0.45);
  background: rgba(255,80,80,0.10);
  color: rgba(255,235,235,0.92);
  animation: hostNextPulse 1.6s ease-in-out infinite;
}
.hostPage .btn.nextWaiting{
  border-color: rgba(255,255,255,0.22);
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.72);
}
.hostPage .btn.nextReady{
  border-color: rgba(120,255,170,0.28);
  background: rgba(120,255,170,0.07);
  color: rgba(235,255,245,0.92);
}
/* ===== end host next feedback ===== */


.confirmRow{ width:100%; display:flex; justify-content:center; }
.btn.confirm{
  width:min(320px, 92%);
  padding:14px 18px;
  font-size:14px;
  letter-spacing:0.12em;
  text-transform:uppercase;
}
#confirmRow{ margin-top:18px; margin-bottom:14px; }

/* ===== Lobby ===== */
.lobbyMsg{
  width:min(620px, 100%);
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:14px;
  text-align:center;
  font-size:12px;
  color: rgba(255,255,255,0.75);
  letter-spacing:0.04em;
  text-transform:uppercase;
}

/* ===== Panels ===== */
#panelGame{
  transition: transform 1400ms cubic-bezier(0.22, 1, 0.36, 1);
  will-change: transform;
}

.playerPanel{
  width:min(980px, 100%);
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:14px;
  /* Slower + smoother for panel expand/collapse */
  transition: transform 1400ms cubic-bezier(0.22, 1, 0.36, 1);
  will-change: transform;
}
.playerPanelTitle{
  font-size:12px;
  letter-spacing:0.12em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.62);
  margin-bottom:10px;
  text-align:center;
}

/* ===== Score panel fade (Player reveal) ===== */
.scorePanel{
  /* Inside the same player panel: no separate background/border box. */
  margin-top:16px;
  background: transparent;
  border: none;
  box-shadow: none;

  /* Smooth open/close without max-height snapping. */
  display:grid;
  grid-template-rows:0fr;
  transition: grid-template-rows 1300ms cubic-bezier(0.22, 1, 0.36, 1);
}

.scorePanel .scoreInner{
  overflow:hidden;
  padding-top:16px;
  /* Extra breathing room so the math row and tile shadows never look clipped */
  padding-bottom:24px;
}

.scorePanel.scoreOpen{
  grid-template-rows:1fr;
}


.scorePanel .board{
  padding: 0 12px;
}

.scorePanel .tiles{
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
  opacity:0;
  transition: opacity 700ms ease;
}

.scorePanel.scoreShown .tiles{
  opacity:1;
}

.scorePanel .tile{
  /* Player scoreboard tiles: give a little extra vertical breathing room.
     Fixed heights can cause occasional clipping on some font/zoom combos (notably iOS). */
  width:190px;
  min-height:148px;
  height:auto;
  padding:14px 16px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(0,0,0,0.34);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06), inset 0 0 60px rgba(0,0,0,0.55);
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
}

.scorePanel .tile .name{
  font-size:18px;
  letter-spacing:0.12em;
  opacity:0.85;
}

.scorePanel .tile .num{
  margin-top:16px;
  font-size:54px;
  text-align:center;
  letter-spacing:0.04em;
}

.scorePanel .tile .d1,
.scorePanel .tile .d2{
  margin-top:10px;
  font-size:18px;
  text-align:center;
  opacity:0.85;
}

.scorePanel .tile .dNeg{ color: #ff4d4d; }
.scorePanel .tile .dZero{ color: #8a8a8a; }

.scorePanel .mathRow{
  margin-top:14px;
  text-align:center;
  font-size:22px;
  /* Fade only (no slide) so it can never clip */
  transform:none;
}


/* ===== Player scoreboard — mobile layout (match desktop cards, 4 columns) ===== */
@media (max-width: 600px){
  .scorePanel .board{ padding: 0 10px; }

  /* 4 tiles per row + enough vertical space so name/score/delta always fit */
  .scorePanel .tiles{
    display:grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    column-gap:8px;
    row-gap:22px;
    justify-content:stretch;
    align-items:start;
  }

  /* Keep the SAME card look as desktop, just scaled to fit 4-up on phones */
  .scorePanel .tile{
    width:100%;
    min-height:0;
    height:auto;
    padding:10px 8px;
  }

  .scorePanel .tName{
    font-size:10px;
    letter-spacing:0.10em;
    margin-bottom:6px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }

  .scorePanel .tGuess{
    font-size:22px;
    padding:4px 0 8px;
  }

  .scorePanel .tScoreWrap{
    min-height:22px;
    height:1.8em;
  }
  .scorePanel .scoreNum{ font-size:10px; }

  .scorePanel .tDelta{
    margin-top:8px;
    font-size:10px;
    letter-spacing:0.06em;
  }

  /* Math row: add side padding so it doesn't sit against the tiles */
  .scorePanel .mathRow{
    margin-top:18px;
    padding:0 6px;
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    gap:8px;
    font-size:14px;
  }
  .scorePanel .mathRow .mBox:first-child{ justify-self:start; }
  .scorePanel .mathRow .mOp{ justify-self:center; }
  .scorePanel .mathRow .mBox:last-child{ justify-self:end; }
}
/* ===== END mobile scoreboard ===== */



/* ===== Grid ===== */
.gridWrap{
  width:100%;
  display:flex;
  justify-content:center;
  transition: transform 420ms ease, opacity 420ms ease;
}
.grid{
  width:min(520px, 92vw);
  aspect-ratio: 1 / 1;
  display:grid;
  grid-template-columns: repeat(10, 1fr);
  grid-auto-rows: 1fr;
  gap:2px;
  border:1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.35);
}
.cell{
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  letter-spacing:0.06em;
  user-select:none;
  cursor:pointer;
  background: rgba(0,0,0,0.55);
  color: rgba(255,255,255,0.50);
  transition: transform 200ms ease, background 200ms ease, color 200ms ease, opacity 200ms ease, box-shadow 200ms ease;
}
.cell.empty{
  cursor:default;
  opacity:0.18;
  background: rgba(0,0,0,0.40);
}
.cell.selected,
.cell.confirmed{
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.92);
  transform: translateY(-1px);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.10), 0 0 22px rgba(255,255,255,0.10);
}
.grid.locked .cell{ cursor:default; }

.grid.revealLock{
  filter: brightness(0.92);
}
.grid.revealLock .cell{ cursor:default; }

/* >>> Nieuw: na bevestigen niet meer klikbaar <<< */
.grid.lockedAfterConfirm .cell{
  pointer-events:none;
  cursor:default;
}

.grid.hasConfirmed .cell:not(.confirmed):not(.empty){
  opacity:0.14;
  color: rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.52);
}

/* cascade */
.grid.cascading .cell{ opacity:0; transform: translateY(8px); }
.cell.appear{
  opacity:1;
  transform: translateY(0);
  animation: cellIn 480ms ease forwards;
}
@keyframes cellIn{
  from{opacity:0; transform: translateY(10px);}
  to{opacity:1; transform: translateY(0);}
}
.grid.animating .cell{ pointer-events:none !important; }

/* ===== Rules ===== */
.rules{
  width:100%;
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:12px;
  margin-top:14px;
}
.rulesTitle{
  font-size:12px;
  letter-spacing:0.10em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.65);
  margin-bottom:8px;
}
.ruleItem{
  font-size:12px;
  color: rgba(255,255,255,0.72);
  padding:6px 0;
  border-top:1px solid rgba(255,255,255,0.06);
}
.ruleItem:first-of-type{ border-top:none; }

.ruleItem.pulseOnce{
  animation: rulePulseSoft 1.6s ease-in-out infinite;
}
@keyframes rulePulseSoft{
  0%{
    color: rgba(255,255,255,0.58);
    text-shadow:
      0 0 10px rgba(255,255,255,0.16),
      0 0 24px rgba(255,255,255,0.08);
  }
  50%{
    color: rgba(255,255,255,0.98);
    text-shadow:
      0 0 26px rgba(255,255,255,0.55),
      0 0 90px rgba(255,255,255,0.30),
      0 0 150px rgba(255,255,255,0.16);
  }
  100%{
    color: rgba(255,255,255,0.58);
    text-shadow:
      0 0 10px rgba(255,255,255,0.16),
      0 0 24px rgba(255,255,255,0.08);
  }
}

/* ===== Scoreboard ===== */
.board{
  width:100%;
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:12px;
}

/* Player: the scoreboard 'board' wrapper is only a layout helper;
   keep it visually neutral so tiles sit in the same panel as the math row. */
#playView #scoreboard.board{
  background: transparent;
  border: 0;
  padding: 0;
  box-shadow: none;
}


.tiles{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
  overflow:visible;
  padding-bottom:6px;
}
@media (max-width: 520px){
  .tiles{
    flex-wrap:nowrap;
    overflow-x:auto;
    scrollbar-width:none;
  }
  .tiles::-webkit-scrollbar{ display:none; }
}

/* ===== Tiles ===== */
.tile{
  flex: 0 0 auto;
  width: 170px;
  border:1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.30);
  padding:10px;
  opacity:0;
  transform: translateY(10px);
  transition: opacity 520ms ease, transform 520ms ease, box-shadow 520ms ease, border-color 520ms ease;
}
.tile.show{ opacity:1; transform: translateY(0); }

/* Player request: scoreboard tiles should only fade (no slide/move) */
#playView .tile{
  transform: none;
  transition: opacity 520ms ease, box-shadow 520ms ease, border-color 520ms ease, background 520ms ease;
}
#playView .tile.show{
  transform: none;
}

/* Iets compacter op player-scherm (maar tekstgroottes gelijk houden) */
#playView #scoreTiles .tile{
  width: 150px;
}

.tile.dead{
  border-color: rgba(255,70,70,0.25);
}
.tile.winner{
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.12), inset 0 0 26px rgba(255,255,255,0.08);
}

.tName{
  font-size:12px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.80);
  margin-bottom:8px;
}
.tGuess{
  font-size:28px;
  letter-spacing:0.06em;
  color: rgba(255,255,255,0.92);
  text-align:center;
  padding:6px 0 10px;
}
.tScoreWrap{
  position:relative;
  /* Use an em-based height + a px minimum so it scales with text-size/zoom.
     This avoids rare clipping of -9 / -10 etc on some devices. */
  height:1.9em;
  min-height:26px;
  padding:2px 0;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
}
.scoreNum{
  position:absolute;
  left:0; right:0;
  top:0; bottom:0;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-weight:700;
  letter-spacing:0.06em;
  font-size:12px;
  line-height:1.0;
  padding:1px 0;
  opacity:0.85;
  transition: transform 900ms ease, opacity 1100ms ease;
  will-change: transform;
}

/* Player scoreboard total score thinner */
.scorePanel .scoreNum{ font-weight:500; }

.scoreNum.good{ color: rgba(255,255,255,0.86); }
.scoreNum.bad{ color: var(--bad); }

.scoreNum.live{ transform: translateY(0); opacity:0.88; }
.scoreNum.out{ transform: translateY(12px); opacity:0; }
.scoreNum.in{ transform: translateY(-10px); opacity:0; }

.tDelta{
  margin-top:10px;
  font-size:12px;
  text-align:center;
  color: rgba(255,255,255,0.50);
}
.tDelta.bad{ color: var(--bad); }

/* ===== Math row ===== */
.mathRow{
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  margin-top:10px;
  opacity:0;
  transform: translateY(10px);
  transition: opacity 650ms ease, transform 650ms ease;
}
.mathRow.show{
  opacity:1;
  transform: translateY(0);
}

/* Player: math row should fade only (no slide), matching the score tiles. */
#playView .mathRow{
  transform: none;
  transition: opacity 700ms ease;
}
#playView .mathRow.show{
  transform: none;
}
.mathBox{
  border:1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.26);
  padding:10px 12px;
  min-width: 160px;
  text-align:center;
}
.mathLabel{
  font-size:11px;
  letter-spacing:0.10em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.60);
}
.mathValue{
  margin-top:6px;
  font-size:18px;
  letter-spacing:0.06em;
  color: rgba(255,255,255,0.92);
}
.mathOp{
  color: rgba(255,255,255,0.70);
  letter-spacing:0.10em;
  text-transform:uppercase;
}

/* ===== Dead theme ===== */
body.deadTheme{
  box-shadow:
    inset 0 0 0 2px rgba(255,70,70,0.38),
    inset 0 0 80px rgba(255,40,40,0.16),
    inset 0 0 240px rgba(255,20,20,0.09);
}
body.deadTheme .playerPanel{
  border-color: rgba(255,70,70,0.34);
  box-shadow:
    0 0 0 1px rgba(255,70,70,0.14),
    0 0 40px rgba(255,40,40,0.12);
}

.deadNoise{
  position:fixed;
  inset:0;
  pointer-events:none;
  display:none;
  background-image:
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="320" height="320"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="2.05" numOctaves="6" stitchTiles="stitch"/></filter><rect width="320" height="320" filter="url(%23n)"/></svg>');
  opacity:0.055;
  mix-blend-mode: screen;
  filter: contrast(210%) brightness(116%);
  animation: tvSnow 0.070s steps(2) infinite;
}
.deadNoise.on{display:block;}
@keyframes tvSnow{
  0%{transform: translate(0,0) scale(1.12)}
  25%{transform: translate(-10px,6px) scale(1.12)}
  50%{transform: translate(8px,-10px) scale(1.12)}
  75%{transform: translate(-8px,-6px) scale(1.12)}
  100%{transform: translate(10px,8px) scale(1.12)}
}


.deadGlass{
  position:fixed;
  inset:-10vmax; /* a bit larger than the viewport for big cracks */
  pointer-events:none;
  z-index: 9997;
  opacity:0;
  transition: opacity 520ms ease;
}

.deadGlass::before{
  content:"";
  position:absolute;
  inset:-6%;
  background-image: url("dead_glass_gen.svg");
  background-repeat:no-repeat;
  background-size: cover;
  background-position: 50% 50%;

  /* From inside to outside: ~50% -> 100% opacity using a mask */
  -webkit-mask-image: radial-gradient(circle at 50% 50%,
    rgba(0,0,0,0.5) 0%,
    rgba(0,0,0,0.65) 35%,
    rgba(0,0,0,1) 85%,
    rgba(0,0,0,1) 100%);
  mask-image: radial-gradient(circle at 50% 50%,
    rgba(0,0,0,0.5) 0%,
    rgba(0,0,0,0.65) 35%,
    rgba(0,0,0,1) 85%,
    rgba(0,0,0,1) 100%);
  -webkit-mask-repeat:no-repeat;
  mask-repeat:no-repeat;
  -webkit-mask-size:cover;
  mask-size:cover;

  transform: rotate(-1deg) scale(1.08);
}

.deadGlass.on{
  opacity:1;
}
/* ===== Survived ===== */
body.survivedTheme{
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.18),
    inset 0 0 90px rgba(255,255,255,0.12),
    inset 0 0 280px rgba(255,255,255,0.08);
}
.survivedFx{
  position:fixed; inset:0;
  pointer-events:none;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index: 40;
}
.survivedFx.hidden{ display:none; }
.survivedFx::before{
  content:"";
  position:fixed;
  inset:0;
  /* Blur everything behind (but NOT the survived text/glow). */
  /* Softer blur (requested) */
  -webkit-backdrop-filter: blur(2px);
  backdrop-filter: blur(2px);
  background: rgba(0,0,0,0.06);
}

/* Host: when the game is over, pulse the Reset button so it's obvious what to do. */
.hostPage #resetBtn.resetPulse{
  animation: resetPulseGlow 1.15s ease-in-out infinite;
}
@keyframes resetPulseGlow{
  0%,100%{
    opacity: 0.86;
    box-shadow:
      0 0 0 1px rgba(255,255,255,0.10),
      0 0 0 rgba(255,255,255,0.0);
  }
  50%{
    opacity: 1;
    box-shadow:
      0 0 0 1px rgba(255,255,255,0.22),
      0 0 26px rgba(255,255,255,0.18);
  }
}
.survivedText{
  position: relative;
  z-index: 1;
  font-size:30px;
  letter-spacing:0.24em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.92);
  text-shadow:
    0 0 14px rgba(255,255,255,0.18),
    0 0 44px rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.18);
  background: rgba(0,0,0,0.18);
  padding:18px 22px;
  animation: survivedBreath 1.6s ease-in-out infinite;
}
@keyframes survivedBreath{
  0%,100%{ transform: scale(0.985); opacity:0.82; }
  50%{ transform: scale(1.02); opacity:1; }
}

/* ===== Host page ===== */
.hostPage .wrap{ display:none; }

/* Host access lock: keep host screen empty (background only) until code is entered */
.hostPage.hostLocked .hostWrap,
.hostPage.hostLocked #settingsFab{
  display:none !important;
}

.hostWrap{
  max-width: 1040px;
  margin: 0 auto;
  padding: 14px;
  min-height: 100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:10px;
}
.hostHeader{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;
  justify-content:space-between;
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:10px 10px;
}
.hostTitle{
  letter-spacing:0.16em;
  text-transform:uppercase;
  font-size:13px;
  color: rgba(255,255,255,0.82);
}
.hostHint{ font-size:12px; color: rgba(255,255,255,0.55); }
.hostBtns{ display:flex; gap:6px; flex-wrap:wrap; }

/* Host toggle switch */
.hostToggle{
  display:flex;
  align-items:center;
  gap:10px;
  margin-left:10px;
  padding:8px 10px;
  border:1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.25);
  color: rgba(255,255,255,0.72);
  font-size:12px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  user-select:none;
}
.hostToggle input{ width:18px; height:18px; accent-color: rgba(255,255,255,0.85); }
.hostToggle span{ white-space:nowrap; }

.hostTiles{
  display:flex;
  gap:8px;
  justify-content:center;
  flex-wrap:wrap;
}
.hostWrap .mathRow{ width:100%; justify-content:center; }

/* Host: keep the math row mounted so the header/buttons never jump when average/target updates. */
.hostPage #mathRow{
  opacity: 1;
  transform: none;
  transition: none;
  min-height: 74px;
}
.hostPage #mathRow.dim{
  opacity: 0.70;
}


.hostTile .tHeadRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.kickBtn{
  width:26px;
  height:26px;
  line-height:26px;
  text-align:center;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.35);
  color: rgba(255,255,255,0.80);
  cursor:pointer;
  padding:0;
}
.kickBtn.armed{
  border-color: rgba(255,255,255,0.22);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.10), 0 0 18px rgba(255,255,255,0.10);
}
.kickBtn:hover{
  border-color: rgba(255,255,255,0.22);
  background: rgba(255,255,255,0.06);
}

/* host rules */
.rulesHost{
  border:1px solid rgba(255,255,255,0.06);
  background: var(--panel);
  padding:12px;
}
.rhTitle{
  font-size:12px;
  letter-spacing:0.10em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.65);
  margin-bottom:10px;
}
.rhItem{
  border-top:1px solid rgba(255,255,255,0.06);
  padding:10px 0;
}
.rhItem:first-of-type{ border-top:none; }
.rhHead{
  font-size:12px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color: rgba(255,255,255,0.78);
  margin-bottom:6px;
}
.rhBody{
  font-size:12px;
  color: rgba(255,255,255,0.68);
  line-height:1.35;
}
.rhItem.pulseOnce .rhHead,
.rhItem.pulseOnce .rhBody{
  animation: rulePulseSoft 1.6s ease-in-out infinite;
}

/* Host status colors */
.rulesHost .status.active{ color: rgba(120,255,170,0.92); }
.rulesHost .status.inactive{ color: rgba(255,110,110,0.92); }

/* ===== Info page ===== */
.infoPage .infoBlackout{
  position:fixed; inset:0;
  background:#000;
}
.infoPage .infoStage{
  position:fixed; inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
  opacity:0;
  transition: opacity 1800ms ease, box-shadow 1400ms ease;
}
.infoPage .infoStage.visible{ opacity:1; }

/* Player-side info reveal overlay (same scene styling as info page, but mountable on player) */
.playerRevealOverlay{
  position:fixed;
  inset:0;
  z-index:9998;
  pointer-events:auto; /* block taps during reveal */
}
.playerRevealOverlay.hidden{ display:none; }
.playerRevealOverlay.hiding{ pointer-events:none; }
.playerRevealOverlay.hiding .playerRevealBlackout{ opacity:0; transition: opacity 520ms ease; }
.playerRevealOverlay.hiding .playerRevealStage{ opacity:0; transition: opacity 520ms ease, box-shadow 520ms ease; }
.playerRevealOverlay.hiding .infoRoundRules{ opacity:0; transition: opacity 520ms ease; }

.playerRevealBlackout{
  position:absolute;
  inset:0;
  background:#000;
  opacity:0;
  transition: opacity 420ms ease;
}
.playerRevealOverlay.black .playerRevealBlackout{ opacity:1; }
.playerRevealStage{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
  opacity:0;
  /* Match the info screen stage fade timing */
  transition: opacity 1800ms ease, box-shadow 1400ms ease;
}
.playerRevealOverlay.showStage .playerRevealStage{ opacity:1; }

/* Ensure the player-side reveal looks IDENTICAL to the info screen (copy of .infoPage tweaks) */
.playerRevealOverlay .mathLabel{
  font-size: clamp(13px, 1.8vw, 18px);
  letter-spacing: 0.10em;
}
.playerRevealOverlay .mathValue{
  font-size: clamp(22px, 3.4vw, 40px);
}
.playerRevealOverlay .infoScoresRow .scoreNum{
  font-weight: 400;
}

/* Round rule intro inside the player reveal overlay (match info screen) */
.playerRevealOverlay .infoRoundRules{
  position:fixed;
  inset:0;
}


.infoFrame{
  width:min(1800px, 98vw);
  height:min(980px, 96vh);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:26px;
}

.infoContent{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:22px;
  opacity:0;
  transform: translateY(10px);
  transition: opacity 1800ms ease, transform 1400ms ease, text-shadow 1400ms ease;
}
.infoContent.show{
  opacity:1;
  transform: translateY(0);
}

.infoTiles{
  width:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:18px;
  flex-wrap:wrap;
  overflow:visible;
}
.infoTiles .tile{
  width: min(420px, 30vw);
  padding:22px;
}
.infoTiles .tName{
  font-size:18px;
  margin-bottom:12px;
}
.infoTiles .tGuess{
  font-size:72px;
  padding:10px 0 18px;
}
.infoTiles .scoreNum{
  font-size:22px;
}
.infoTiles .tDelta{
  font-size:18px;
  margin-top:14px;
}
.infoTiles .tScoreWrap{ height:28px; }

/* Round rules overlay — cinematic: bg fades in, text pops in, then both fade out */
.infoRoundRules{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:40px;
  color: rgba(255,255,255,0.94);
  pointer-events:none;
  z-index: 9999;
}
.infoRoundRules::before{
  content:"";
  position:absolute;
  inset:0;
  background:#000;
  opacity:0;
  transition: opacity var(--rrFadeInMs, 650ms) ease;
}
/* background fade-in */
.infoRoundRules.showBg::before{ opacity:0.86; }

/* Text is inserted inside .rrContent. It should pop in (no fade) */
.infoRoundRules .rrContent{
  position:relative;
  visibility:hidden;
  opacity:1;
}
.infoRoundRules.textOn .rrContent{ visibility:visible; }

/* Fade out BOTH bg + text together */
.infoRoundRules.fadeOut::before{
  opacity:0;
  transition: opacity var(--rrFadeOutMs, 5000ms) ease;
}
.infoRoundRules.fadeOut .rrContent{
  opacity:0;
  transition: opacity var(--rrFadeOutMs, 5000ms) ease;
}
.infoRoundRules .rrTitle{
  font-size:44px;
  letter-spacing:0.26em;
  text-transform:uppercase;
  opacity:0.95;
  margin-bottom:26px;
  text-shadow:
    0 0 30px rgba(255,255,255,0.30),
    0 0 120px rgba(255,255,255,0.18);
}
.infoRoundRules .rrBig{
  width:min(1600px, 96vw);
  display:grid;
  gap:22px;
}
.infoRoundRules .rrLine{
  font-size:46px;
  line-height:1.12;
  letter-spacing:0.03em;
  text-align:center;
  text-shadow:
    0 0 34px rgba(255,255,255,0.35),
    0 0 160px rgba(255,255,255,0.20);
}
@media (max-width: 900px){
  .infoRoundRules .rrTitle{ font-size:30px; }
  .infoRoundRules .rrLine{ font-size:26px; }
}


/* =========================
   INFO SCREEN — REVEAL ANIMATION (V2)
   ========================= */

.infoScene{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:18px;
  opacity:1;
}

.infoNamesRow,
.infoGuessesRow,
.infoScoresRow,
.infoDeltasRow{
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:16px;
  flex-wrap:wrap;
}


/* Keep scores/deltas a bit closer by default (no layout jump when revealed) */
.infoScoresRow,
.infoDeltasRow{ margin-top:-10px; }

/* Winner highlight (INFO): subtle glow around the winner tile/name */
.infoGuessTile.winner .guessNum{
  text-shadow: 0 0 18px rgba(255,255,255,.35);
}
.infoGuessTile.winner{
  box-shadow: 0 0 0 1px rgba(255,255,255,.22), 0 0 28px rgba(255,255,255,.14);
}
.infoName.winner{
  text-shadow: 0 0 18px rgba(255,255,255,.28);
}

/* Reserve space for all rows to avoid any final layout 'knip'.
   We only animate opacity/transform, not height. */
.infoNamesRow,
.infoScoresRow,
.infoDeltasRow{
  height: 56px;
  opacity:0;
  overflow:hidden;
  transform: translateY(-6px);
  transition: opacity 1400ms ease, transform 1400ms ease;
}

.infoCell{
  width: clamp(220px, 15vw, 360px);
  text-align:center;
}

.infoScore,
.infoDelta{
  position:relative;
  height:44px;
}

.infoName{
  font-size:30px;
  font-weight:400;
  letter-spacing:.06em;
  opacity:0;
  transform: translateY(6px);
  transition: opacity 1800ms ease, transform 1400ms ease, text-shadow 1400ms ease;
}

.infoGuessTile{
  border:1px solid rgba(255,255,255,.08);
  background: rgba(0,0,0,.35);
  padding:24px 12px;
  opacity:0;
  transition: opacity 1800ms ease, box-shadow 1400ms ease;
}

.infoGuessTile .guessNum{
  font-size:84px;
  transition: text-shadow 1400ms ease;
  font-weight:700;
  line-height:1.15;
  color: rgba(255,255,255,.92);
}

.infoScore, .infoDelta{
  opacity:0;
  transform: translateY(6px);
  transition: opacity 1800ms ease, transform 1400ms ease, text-shadow 1400ms ease;
}

/* Score animatie wrapper (zoals scoreNum) */
.infoScore{ position:relative; height:32px; overflow:hidden; }
.infoScore .scoreNum{ font-size:26px; font-weight:800; }
.infoDelta .deltaNum{ font-weight:500; }


/* Delta animatie wrapper (zoals score) */
.infoDelta{ position:relative; height:32px; overflow:hidden; }
.infoDelta .deltaNum{
  position:absolute;
  left:0; right:0;
  text-align:center;
  font-weight:800;
  letter-spacing:.04em;
  font-size:26px;
  opacity:0.88;
  transition: transform 900ms ease, opacity 1100ms ease;
  color: rgba(210,210,210,.85);
}
.infoDelta .deltaNum.bad{ color: rgba(255,70,70,.95); }
.infoDelta .deltaNum.neutral{ color: rgba(210,210,210,.75); }
.infoDelta .deltaNum.live{ transform: translateY(0); opacity:0.92; }
.infoDelta .deltaNum.out{ transform: translateY(14px); opacity:0; }
.infoDelta .deltaNum.in{ transform: translateY(-12px); opacity:0; }


.infoMathRow .mathValue{
  font-size: clamp(32px, 3.6vw, 50px);
  letter-spacing:0.04em;
}
/* math row (staged) */
/* Math row (absolute staged: avg -> op -> target) */
.infoMathRow{
  --mathGap: 420px;
  position:relative;
  width:100%;
  height:0px; /* collapsed in step 1 so guesses are truly centered */
  margin-top:0;
  opacity:0;
  transform: translateY(14px);
  transition: opacity 1800ms ease, transform 1400ms ease, height 1400ms ease, margin-top 1400ms ease;
}
.infoMathRow > *{ position:absolute; top:50%; left:50%; }

.bigMath{
  width: clamp(280px, 18vw, 420px);
  padding:18px 16px;
  transform: translate(-50%, -50%);
  opacity:0;
  transition: opacity 1400ms ease, transform 1400ms ease;
}


.bigMathOp{
  font-size:44px;
  font-weight:400;
  letter-spacing:0.04em;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  transform: translate(-50%, -50%);
  clip-path: inset(0 100% 0 0);
  transition: clip-path 1200ms ease, opacity 600ms ease;
}
.infoScene.ready .infoGuessesRow{ /* keep stable layout */ }

.infoScene.s1 .infoGuessTile{
  opacity:1;
}
.infoScene.s1 .infoNamesRow{ opacity:1; transform: translateY(0); }
.infoScene.s1 .infoName{ opacity:1; transform: translateY(0); }

.infoScene.s2 .infoGuessesRow{
  transform: translateY(-16px);
  transition: transform 1800ms ease;
}
.infoScene.s2 .infoMathRow{
  height:140px;
  margin-top:10px;
  opacity:1;
  transform: translateY(-34px);
}

/* s2: alleen gemiddelde gecentreerd */

/* Target start al op rechts (alleen opacity/y animatie) */
#infoTargetBox{
  transform: translate(calc(-50% + var(--mathGap, 320px)), -50%);
  opacity:0;
}
.infoScene.s2 #infoAvgBox{
  opacity:1;
  transform: translate(-50%, -50%);
}

/* s3a: gemiddelde schuift links */
.infoScene.s3a #infoAvgBox{
  transform: translate(calc(-50% - var(--mathGap, 320px)), -50%);
}
.infoScene.s3 .bigMathOp{
  opacity:1;
  clip-path: inset(0 0 0 0);
}

/* Instant final-state (e.g. info refreshed after reveal is already done):
   do NOT replay any fades/left-to-right reveals. */
.infoScene.instant,
.infoScene.instant *{
  transition: none !important;
  animation: none !important;
}
.infoScene.instant .bigMathOp{
  clip-path: inset(0 0 0 0) !important;
  opacity: 1 !important;
}

/* Late-join helper: keep the operator locked in its final state so it doesn't
   replay its reveal once when the page loads mid-animation. */
.infoScene.opDone .bigMathOp{
  clip-path: inset(0 0 0 0) !important;
  opacity: 1 !important;
  transition: none !important;
  animation: none !important;
}

/* Phone-friendly layout for the big reveal scene */
@media (max-width: 600px){
  .infoFrame{ height: 96vh; gap: 14px; }
  .infoCell{ width: clamp(140px, 42vw, 240px); }
  .infoName{ font-size: 18px; }
  .infoGuessTile{ padding: 14px 10px; }
  .infoGuessTile .guessNum{ font-size: 52px; }

  .infoMathRow{ --mathGap: 190px; }
  .bigMath{ width: clamp(160px, 44vw, 260px); padding: 12px 10px; }
  .bigMathOp{ font-size: 28px; }
  .bigMathAvg, .bigMathTarget{ font-size: 18px; }

  /* Allow wrap without clipping */
  .infoNamesRow,
  .infoScoresRow,
  .infoDeltasRow{ height: auto; min-height: 44px; }

  /* === Phone layout (single per-player card grid) ===
     Fixes: row 2+ misalignment where names/scores/deltas wrap differently than guess tiles.
     When JS adds .phone to .infoScene, we render everything inside the guess tile itself. */
  .infoScene.phone{
    gap: 16px;
  }

  .infoScene.phone .infoNamesRow,
  .infoScene.phone .infoScoresRow,
  .infoScene.phone .infoDeltasRow{
    display:none !important;
    height:0 !important;
    min-height:0 !important;
    margin:0 !important;
    padding:0 !important;
  }

  .infoScene.phone .infoGuessesRow{
    display:grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    column-gap: 10px;
    /* Extra space between rows so there is room for: name + score + delta */
    row-gap: 26px;
    padding: 0 14px;
    justify-content:center;
    align-items:start;
  }

  .infoScene.phone .infoCell{ width:auto; }

  /* Outer tile becomes a wrapper; the square lives on .guessNum */
  .infoScene.phone .infoGuessTile{
    border: none;
    background: transparent;
    padding: 0;
    box-shadow: none;
    /* Override generic phone rules: stack name ABOVE square tile, then score/delta. */
    display:flex;
    flex-direction:column;
    align-items:stretch;
    justify-content:flex-start;
    aspect-ratio: auto;
  }

  .infoScene.phone .gName{
    text-align:center;
    font-size: 11px;
    letter-spacing: 0.10em;
    text-transform: uppercase;
    color: rgba(255,255,255,0.86);
    margin-bottom: 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .infoScene.phone .infoGuessTile .guessNum{
    width: 100%;
    aspect-ratio: 1 / 1;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.35);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.06), inset 0 0 36px rgba(0,0,0,.55);
    padding: 0;
    line-height: 1;
    font-size: 28px;
    font-weight: 800;
  }

  /* Winner glow should frame the SQUARE box */
  .infoScene.phone .infoGuessTile.winner .guessNum{
    text-shadow: 0 0 16px rgba(255,255,255,.32);
    box-shadow:
      inset 0 0 0 1px rgba(255,255,255,.18),
      0 0 18px rgba(255,255,255,.10),
      inset 0 0 42px rgba(0,0,0,.55);
  }

  .infoScene.phone .gMeta{
    margin-top: 10px;
    display:flex;
    flex-direction:column;
    gap: 6px;
    align-items:center;
  }

  .infoScene.phone .infoScore,
  .infoScene.phone .infoDelta{
    height: 22px;
    opacity: 0;
    transform: translateY(6px);
    transition: opacity 1800ms ease, transform 1400ms ease, text-shadow 1400ms ease;
  }

  /* When we reach the final stage, show score + delta inside each card */
  .infoScene.phone.s4 .infoScore,
  .infoScene.phone.s4 .infoDelta{
    opacity: 1;
    transform: translateY(0);
  }

  .infoScene.phone .infoScore .scoreNum{ font-size: 14px; font-weight: 800; }
  .infoScene.phone .infoDelta .deltaNum{ font-size: 14px; }

  /* Give the math row some extra breathing room from the player grid */
  .infoScene.phone.s4 .infoMathRow{ transform: translateY(28px); }
}

/* s3b: target verschijnt rechts */
.infoScene.s3b #infoTargetBox{
  opacity:1;
  transform: translate(calc(-50% + var(--mathGap, 320px)), -50%);
}


/* s4a: math row makes room (moves down) BEFORE scores appear */
/* Pre-expand rows during s4a (still invisible) to avoid any "knip" when s4 turns them on. */
.infoScene.s4a .infoMathRow{
  transform: translateY(10px);
  transition: transform 1600ms ease;
}

/* s4: reveal names + scores + deltas */

/* In the final stage, keep guesses slightly up but avoid overlap with names */
.infoScene.s4 .infoGuessesRow{
  transform: translateY(-10px);
}

.infoScene.s4 .infoMathRow{
  transform: translateY(18px);
}

.infoScene.s4 .infoScoresRow,
.infoScene.s4 .infoDeltasRow{ opacity:1; transform: translateY(0); }
.infoScene.s4 .infoName,
.infoScene.s4 .infoScore,
.infoScene.s4 .infoDelta{
  opacity:1;
  transform: translateY(0);
}

/* Now that we are in s4, allow these rows to take space */

/* Make the whole block feel centered even with wrapping */
.infoFrame{
  width:min(1800px, 98vw);
  height:min(980px, 96vh);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:18px;
}

/* Ensure old infoContent doesn't affect layout (legacy) */
.infoContent{ display:none !important; }
.infoTiles{ display:none !important; }


/* INFO tweaks v10 */
.infoPage .mathLabel{ font-size: clamp(12px, 1.2vw, 16px); }
.infoPage .mathValue{ font-size: clamp(22px, 3.4vw, 40px); }
.infoPage .infoScoresRow .scoreNum{ font-weight:400; }


/* ===== INFO-only tweaks ===== */
.infoPage .mathLabel{
  font-size: clamp(13px, 1.8vw, 18px);
  letter-spacing: 0.10em;
}
.infoPage .tScoreWrap .scoreNum{
  font-weight: 500; /* total score dunner op info */
}



/* Settings button (host) */
.settingsFab{
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 10px;
}
.settingsPanel{
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(10,10,10,.58);
  padding: 10px 10px;
  display:flex;
  flex-direction:column;
  gap: 10px;
  min-width: 190px;
}
.settingsPanelBtn{
  width: 100%;
}

/* Debug button (host) */

.debugFab{
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.debugBtn{
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(10,10,10,.65);
  color: rgba(255,255,255,.86);
  padding: 10px 14px;
  font-size: 12px;
  letter-spacing: .12em;
  text-transform: uppercase;
  cursor: pointer;
}
.debugBtn:hover{ background: rgba(20,20,20,.75); }
.debugToast{
  align-self: flex-end;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.55);
  color: rgba(255,255,255,.80);
  padding: 8px 10px;
  font-size: 12px;
}

/* (removed v46 variant override) */


/* ===== v53A overrides ===== */
/* Player scoreboard: prevent total score clipping during slide animation */
/* The total score line was still getting clipped on some zoom/font combos.
   For player tiles we switch to a fade-only total score animation and
   vertically center using flex (no font-metric surprises). */
#playView .tScoreWrap{
  /* Keep it fade-only, but make the wrapper scale with any text sizing/zoom.
     This is the most reliable way to avoid rare clipping of -9 / -10 etc. */
  height: 2.4em;
  min-height: 36px;
  padding: 3px 0;
  overflow:hidden;
}
#playView .scoreNum{
  top:0;
  bottom:0;
  display:flex;
  align-items:center;
  justify-content:center;
  line-height:1.15;
}
#playView .scoreNum.live{ transform:none; }
#playView .scoreNum.out{ transform:none; }
#playView .scoreNum.in{ transform:none; }


/* === BG editor (host) === */
.bgEditorOpenBtn{
  margin-top:8px;
  width:100%;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(10,12,18,.55);
  color:#fff;
  cursor:pointer;
  font-weight:600;
}
.bgEditorOpenBtn:hover{ background: rgba(10,12,18,.68); }

.bgEditorModal{
  position:fixed;
  inset:0;
  z-index:9999;
  background: rgba(0,0,0,.55);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding:14px;
}
.bgEditorCard{
  width:min(1100px, 100%);
  max-height: calc(100vh - 28px);
  overflow:auto;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(12,15,23,.92);
  backdrop-filter: blur(10px);
  box-shadow: 0 18px 60px rgba(0,0,0,.55);
  padding:14px;
}
.bgEditorTop{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
}
.bgEditorTitle{ font-size:16px; font-weight:800; letter-spacing:.2px; }
.bgEditorSub{ opacity:.7; font-size:12px; margin-top:2px; }
.bgEditorTopBtns{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.btn.sm{ padding:7px 10px; font-size:12px; border-radius:10px; }

.bgEditorGrid{
  display:grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap:12px;
}
@media (max-width: 980px){
  .bgEditorGrid{ grid-template-columns: 1fr; }
}
.bgEditorCol{
  border-radius:16px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  padding:12px;
}
.bgEditorH{
  font-weight:800;
  opacity:.9;
  margin-bottom:10px;
}
.bgCtl{
  display:block;
  margin:10px 0;
}
.bgCtlRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  font-size:12px;
  margin-bottom:6px;
}
.bgVal{
  opacity:.75;
  font-variant-numeric: tabular-nums;
}
.bgTwo{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
.bgBtnRow{ display:flex; gap:8px; flex-wrap:wrap; }
.bgMiniBtn{
  padding:7px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(8,10,14,.55);
  color:#fff;
  cursor:pointer;
  font-weight:700;
}
.bgMiniBtn:hover{ background: rgba(8,10,14,.70); }
.bgMiniBtn.active{
  border-color: rgba(255,255,255,.45);
  background: rgba(255,255,255,.12);
}
.bgEditorHint{
  margin-top:12px;
  font-size:12px;
  opacity:.75;
  line-height:1.35;
}




/* ===== Info / Player reveal scene — phone layout (aligned rows, names above tiles) ===== */
@media (max-width: 600px){
  /* We keep the SAME structure as desktop (names row above, scores/deltas below),
     but we force EVERY row to wrap in the exact same way.
     This fixes the “row 2 names don’t sit above row 2 tiles” issue AND keeps
     the last row nicely centered (e.g. 5 players => 1 centered tile). */

  .infoFrame{
    width: min(980px, 96vw);
    height: min(980px, 94vh);
  }

  .infoScene{ gap: 12px; }

  /* Responsive column count (4 on most phones, 3 on very small screens). */
  .infoScene{ --cols: 4; --colGap: 8px; --rowGap: 18px; }

  .infoNamesRow,
  .infoGuessesRow,
  .infoScoresRow,
  .infoDeltasRow{
    width: min(760px, 96vw);
    margin-left:auto;
    margin-right:auto;
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    align-items:center;
    gap: var(--rowGap) var(--colGap);
  }

  /* Let rows size themselves (no fixed reserved height on phones). */
  .infoNamesRow,
  .infoScoresRow,
  .infoDeltasRow{ height:auto; min-height: 0; overflow: visible; }

  /* Every cell uses the same width across all rows, so wraps line up perfectly. */
  .infoCell{
    width:auto;
    min-width:0;
    flex: 0 0 calc((100% - (var(--cols) - 1) * var(--colGap)) / var(--cols));
    max-width: calc((100% - (var(--cols) - 1) * var(--colGap)) / var(--cols));
    text-align:center;
  }

  /* Names ABOVE tiles */
  .infoName{
    font-size: 12px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Guess tiles: compact & landscape */
  .infoGuessTile{
    width: 100%;
    padding: 10px 6px;
    aspect-ratio: 1.7 / 1;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .infoGuessTile .guessNum{
    font-size: 34px;
    line-height: 1.05;
  }

  /* Score/delta rows: compact, readable */
  .infoScore,
  .infoDelta{ height: 18px; }
  .infoScore .scoreNum{ font-size: 14px; font-weight: 700; }
  .infoDelta .deltaNum{ font-size: 14px; font-weight: 700; }

  /* Reduce the default negative row spacing for phone. */
  .infoScoresRow,
  .infoDeltasRow{ margin-top: 0px; }

  /* Math row: smaller so it doesn't touch the edges. */
  .infoMathRow{ --mathGap: 110px; }
  .infoScene.s2 .infoMathRow{ height: 92px; margin-top: 14px; transform: translateY(-6px); }
  .bigMath{ width: 40vw; max-width: 160px; padding: 10px 8px; }
  .bigMathOp{ font-size: 18px; }
  .infoMathRow .mathValue{ font-size: 22px; }
  .mathLabel{ font-size: 10px; letter-spacing:0.14em; }
}

@media (max-width: 360px){
  .infoGuessTile{ aspect-ratio: 1.6 / 1; }
  .infoGuessTile .guessNum{ font-size: 30px; }

  .infoMathRow{ --mathGap: 100px; }
  .bigMath{ max-width: 150px; }
  .bigMathOp{ font-size: 16px; }
  .infoMathRow .mathValue{ font-size: 20px; }
}
/* ===== END phone reveal scene ===== */
/* Host build version */
.hostPage .buildVersion{
  position:fixed;
  left:12px;
  bottom:10px;
  font-size:11px;
  letter-spacing:0.12em;
  color: rgba(255,255,255,0.45);
  text-transform:uppercase;
  pointer-events:none;
  z-index: 60;
}
